version: 2
workers:
- type: router
  realms:
  - name: deskconn
    roles:
    - name: deskconn
      permissions:
        - uri: ''
          match: prefix
          allow:
            register: true
            call: true
            publish: true
            subscribe: true
          disclose:
            caller: false
            publisher: false
          cache: true
  components:
  - type: class
    realm: deskconn
    role: deskconn
    classname: deskconnd.components.AuthSession
  - type: class
    realm: deskconn
    role: deskconn
    classname: deskconnd.components.ServiceDiscoverySession
  transports:
  - type: websocket
    endpoint:
      type: tcp
      port: $DESKCONN_PORT
    auth:
      cryptosign:
        type: dynamic
        authenticator: org.deskconn.deskconnd.authenticate
        authenticator-realm: deskconn
